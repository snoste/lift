\section{Translation of the Requirements into Interaction}

\subsubsection*{Safety}
\begin{enumerate}
	\item Only one gate can be open at a time
		\begin{itemize}
			\item It is only possible to send an openGate(gateID$_i$) to open gate $i$ after a gateState(gateID$_j$, $ \mathbb{B} $) delivers $\mathbb{B} = false$ and openGate(gateID$_j$) has not been issued in the meantime, for gateID$_i \neq$ gateID$_j$
		\end{itemize}
	
	\item Only one valve can be open at a time
		\begin{itemize}
			\item It is only possible to send an openValve(valveID$_i$) to open valve $i$ after a valveState(valveID$_j$, $ \mathbb{B} $) delivers $\mathbb{B} = false$ and openValve(valveID$_j$) has not been issued in the meantime, for valveID$_i \neq$ valveID$_j$
		\end{itemize}
	
	\item A valve and a gate at different levels can never be open at the same time
		\begin{itemize}
			\item It is only possible to send an openGate(gateID$_i$) to open gate $i$ after a valveState(valveID$_j$, $ \mathbb{B} $) delivers $\mathbb{B} = false$ and openValve(valveID$_j$) has not been issued in the meantime, for gate $i$ and valve $j$ are on opposite sides of the lift 
			\item It is only possible to send an openValve(valveID$_i$) to open valve $i$ after a gateState(gateID$_j$, $ \mathbb{B} $) delivers $\mathbb{B} = false$ and openGate(gateID$_j$) has not been issued in the meantime, for valve $i$ and gate $j$ are on opposite sides of the lift
		\end{itemize}
	
	%\item After a ship has entered the sluice the gate will close
	%\begin{itemize}
	%	\item it is not possible to send closeGate(gate\_ID) if getShipPresence(pos\_(same(ID).1),false)	
	%\end{itemize}
	
	\item A gate can only close if there is no ship in between its doors
	\begin{itemize}
		\item It is not possible to send closeGate(gateID$_i$) to close gate $i$ unless gateSensor(gateID$_i$, $\mathbb{B}$) returns $\mathbb{B} = false$ and no other action has been issued in the meantime
	\end{itemize}
	
	\item A gate can only open if the water level on both sides is equal
	\begin{itemize}
		\item It is not possible to send openGate(gateID$_i$) to open gate $i$ unless compareWaterlevel(containerID$_j$, $\mathbb{B}$) returns $\mathbb{B} = true$ and no other action has been issued in the meantime, for gate $i$ and container $j$ are on the same side of the lift
	\end{itemize}
	
	\item Signal lights can never be off nor indicate hold and pass at the same time
		\begin{itemize}
			\item passSignal(signalID$_i$, true) has to be followed directly by a haltSignal(signalID$_i$, false)
			\item haltSignal(signalID$_i$, true) has to be followed directly by a passSignal(signalID$_i$, false)
			\item passSignal(signalID$_i$, false) can only be issued directly after haltSignal(signalID$_i$, true)
			\item haltSignal(signalID$_i$, false) can only be issued directly after passSignal(signalID$_i$, true)
		\end{itemize}
	\item Signal lights can only indicate pass if the gate is completely opened
		\begin{itemize}
			\item It is only possible to send a passSignal(signalID$_i$, true) to set signal $i$ to pass after a gateState(gateID$_j$, $ \mathbb{B} $) delivers $\mathbb{B} = true$ and closeGate(gateID$_j$) has not been issued in the meantime, for signal $i$ and gate $j$ are on the same side of the lift
		\end{itemize}
	\item An entering signal can only indicate pass if there is no ship in the lift already
		\begin{itemize}
			\item It is only possible to send a passSignal(signalID$_i$, true) to set signal $i$ to pass after shipPresence(posID, $\mathbb{B}$) delivers $\mathbb{B} = false$ for posID = (ID of container X.1)
		\end{itemize}
\end{enumerate}

\subsubsection*{Functionality}
\begin{enumerate}
	\item If there is no ship in the lift
		\begin{itemize}
			\item While the system is idle, it should check for arriving ships periodically using the shipPresence(posID$_i$, $\mathbb{B}$) action for all position IDs posID$_i$. If $\mathbb{B} = true$ for one position posID$_i \neq X.1$, the system should issue signalPass(signalID$_i$, true) where signalID$_i$ is the entering signal light at position posID$_i$
		\end{itemize}
		
	\item If a ship has just left the system and there is no other boat waiting, the system should enter idle state
			\begin{itemize}
				\item If shipPresence(posID$_i$, $\mathbb{B}$) returns $\mathbb{B} = false$ for all position IDs posID$_i$:
				\begin{itemize}
					\item For all gate IDs gateID$_i$: If gateState(gateID$_i$, $\mathbb{B}$) returns $\mathbb{B} = true$, closeGate(gateID$_i$) must be issued
					\item For all signal IDs signalID$_i$: If signalState(signalID$_i$, $\mathbb{B}$) returns $\mathbb{B} = true$, haltSignal(signalID$_i$, true) must be issued
					\item Otherwise no action must happen
				\end{itemize}
			\end{itemize}
		\item If a ship has just left the system and there are boats waiting on one side of the lift, the first boat in line gets served 
			\begin{itemize}
				\item If shipPresence(posID$_i$, $\mathbb{B}$) returns $\mathbb{B} = true$ for one position posID$_i \neq X.1$, the system should issue signalPass(signalID$_i$, true) where signalID$_i$ is the entering signal light at position posID$_i$
			\end{itemize}
		\item If a ship has just left the system and there are boats waiting on both sides of the lift, then the first boat on the current level gets served
			\begin{itemize}
				\item If both, shipPresence(posID$_i$, $\mathbb{B}$) and shipPresence(posID$_j$, $\mathbb{B}$) return $\mathbb{B} = true$ for posID$_i \neq$ posID$_j \neq$ posID$_{X.1}$, the system should check the current waterlevel in container X.1 using compareWaterlevel(containerID$_i$, $\mathbb{B}_i$) and compareWaterlevel(containerID$_j$, $\mathbb{B}_j$) (containerID$_i \neq$ containerID$_j \neq$ containerID$_{X.1}$) and then issue passSignal(signalID$_k$, true) where signalID$_k$ is the entering signal light at container $k$ and
				\begin{equation*}
					k = 
					\begin{cases}
						i & \text{if } \mathbb{B}_i = true\\
						j & \text{if } \mathbb{B}_j = true\\
					\end{cases}
				\end{equation*}
			\end{itemize}
	
	\item If a ship hast just entered the lift the system should transport the ship to the other level
		\begin{itemize}
			\item Once a ship has entered the system (shipPresence(posID$_{X.1}$, $\mathbb{B}$) results in $\mathbb{B} = true$ for the first time after resulting in $\mathbb{B} = false$), it should check the current waterlevel in container X.1 using compareWaterlevel(containerID$_i$, $\mathbb{B}_i$) and compareWaterlevel(containerID$_j$, $\mathbb{B}_j$) and then issue passSignal(signalID$_k$, true) where signalID$_k$ is the leaving signal light at container $k$ and
			\begin{equation*}
				k = 
				\begin{cases}
					i & \text{if } \mathbb{B}_i = true\\
					j & \text{if } \mathbb{B}_j = true\\
				\end{cases}
			\end{equation*}
		\end{itemize}
	\end{enumerate}